<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í™€ì§ ê²Œì„ - Private Game Platform</title>
    <link rel="stylesheet" href="../common.css" />
    <link rel="stylesheet" href="css/game.css" />
  </head>
  <body>
    <!-- í—¤ë” -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <a href="dashboard.html" class="logo">ğŸ° PGP</a>
          <nav class="nav">
            <a href="dashboard.html">ëŒ€ì‹œë³´ë“œ</a>
            <a href="game.html">ê²Œì„</a>
            <a href="withdrawal.html">ì¶œê¸ˆ</a>
            <a href="mypage.html">ë§ˆì´í˜ì´ì§€</a>
          </nav>
          <div class="user-info">
            <div class="points-display">
              ğŸ’° <span id="headerPoints">150,000</span>ì›
            </div>
            <a href="login.html" class="btn btn-sm btn-outline">ë¡œê·¸ì•„ì›ƒ</a>
          </div>
        </div>
      </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="main-content">
      <div class="container">
        <div class="game-container">
          <!-- ê²Œì„ í—¤ë” -->
          <div class="game-header">
            <h1 class="game-title">ğŸ² í™€ì§ ê²Œì„</h1>
            <div class="game-status">â— ê²Œì„ ìš´ì˜ ì¤‘</div>
          </div>

          <!-- í¬ì¸íŠ¸ ì •ë³´ -->
          <div class="points-info">
            <div class="current-points">í˜„ì¬ ë³´ìœ  í¬ì¸íŠ¸</div>
            <div class="points-value" id="currentPoints">150,000ì›</div>
          </div>

          <!-- ê²Œì„ ë³´ë“œ -->
          <div class="game-board">
            <!-- ë² íŒ… ê¸ˆì•¡ ì…ë ¥ -->
            <div class="bet-amount-section">
              <label class="form-label">ë² íŒ… ê¸ˆì•¡</label>
              <div class="bet-input-group">
                <input
                  type="number"
                  id="betAmount"
                  class="form-input"
                  placeholder="ê¸ˆì•¡ ì…ë ¥"
                  min="1000"
                  max="100000"
                  step="1000"
                  value="10000"
                />
              </div>
              <div class="quick-bet-buttons">
                <button class="quick-bet-btn" onclick="setBetAmount(1000)">
                  1ì²œ
                </button>
                <button class="quick-bet-btn" onclick="setBetAmount(5000)">
                  5ì²œ
                </button>
                <button class="quick-bet-btn" onclick="setBetAmount(10000)">
                  1ë§Œ
                </button>
                <button class="quick-bet-btn" onclick="setBetAmount(50000)">
                  5ë§Œ
                </button>
                <button class="quick-bet-btn" onclick="setBetAmount(100000)">
                  10ë§Œ
                </button>
              </div>
            </div>

            <!-- í™€ì§ ì„ íƒ -->
            <div class="choice-section">
              <label class="form-label">í™€ì§ ì„ íƒ</label>
              <div class="choice-buttons">
                <div
                  class="choice-btn"
                  id="oddBtn"
                  onclick="selectChoice('odd')"
                >
                  <div class="icon">1ï¸âƒ£</div>
                  <div class="label">í™€</div>
                </div>
                <div
                  class="choice-btn"
                  id="evenBtn"
                  onclick="selectChoice('even')"
                >
                  <div class="icon">2ï¸âƒ£</div>
                  <div class="label">ì§</div>
                </div>
              </div>
            </div>

            <!-- ê²°ê³¼ í‘œì‹œ -->
            <div class="result-display" id="resultDisplay">
              <div class="dice-container" id="diceContainer">?</div>
              <div class="result-text">ì£¼ì‚¬ìœ„ë¥¼ êµ´ë ¤ë³´ì„¸ìš”!</div>
            </div>

            <!-- ë² íŒ… ë²„íŠ¼ -->
            <button
              class="btn btn-primary bet-button"
              id="betButton"
              onclick="placeBet()"
            >
              ë² íŒ…í•˜ê¸°
            </button>

            <!-- ê²Œì„ ì •ë³´ -->
            <div class="game-info">
              ğŸ’¡ ë°°ë‹¹ë¥ : 1.95ë°° | ìµœì†Œ ë² íŒ…: 1,000ì› | ìµœëŒ€ ë² íŒ…: 100,000ì›
            </div>
          </div>

          <!-- ìµœê·¼ ë² íŒ… ê²°ê³¼ -->
          <div class="recent-results">
            <h3>ìµœê·¼ ë² íŒ… ê²°ê³¼</h3>
            <div class="result-list" id="resultList">
              <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- í‘¸í„° -->
    <footer class="footer">
      <div class="container">
        <p>&copy; 2025 Private Game Platform. All rights reserved.</p>
        <p>ë¬¸ì˜: support@pgp.com</p>
      </div>
    </footer>

    <script>
      let currentPoints = 150000;
      let selectedChoice = null;
      let isPlaying = false;
      let recentResults = [];

      // ë² íŒ… ê¸ˆì•¡ ì„¤ì •
      function setBetAmount(amount) {
        document.getElementById("betAmount").value = amount;
      }

      // í™€ì§ ì„ íƒ
      function selectChoice(choice) {
        selectedChoice = choice;
        document.getElementById("oddBtn").classList.remove("selected");
        document.getElementById("evenBtn").classList.remove("selected");

        if (choice === "odd") {
          document.getElementById("oddBtn").classList.add("selected");
        } else {
          document.getElementById("evenBtn").classList.add("selected");
        }
      }

      // ë² íŒ… ì‹¤í–‰
      function placeBet() {
        if (isPlaying) return;

        const betAmount = parseInt(document.getElementById("betAmount").value);

        // ìœ íš¨ì„± ê²€ì‚¬
        if (!betAmount || betAmount < 1000 || betAmount > 100000) {
          alert("ë² íŒ… ê¸ˆì•¡ì„ í™•ì¸í•´ì£¼ì„¸ìš”. (ìµœì†Œ: 1,000ì›, ìµœëŒ€: 100,000ì›)");
          return;
        }

        if (!selectedChoice) {
          alert("í™€ ë˜ëŠ” ì§ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
          return;
        }

        if (betAmount > currentPoints) {
          alert("ë³´ìœ  í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.");
          return;
        }

        isPlaying = true;
        document.getElementById("betButton").disabled = true;

        // ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸° ì• ë‹ˆë©”ì´ì…˜
        rollDice(betAmount);
      }

      // ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°
      function rollDice(betAmount) {
        const diceContainer = document.getElementById("diceContainer");
        const resultDisplay = document.getElementById("resultDisplay");

        diceContainer.classList.add("rolling");

        let count = 0;
        const rollInterval = setInterval(() => {
          diceContainer.textContent = Math.floor(Math.random() * 6) + 1;
          count++;

          if (count >= 20) {
            clearInterval(rollInterval);

            // ìµœì¢… ê²°ê³¼
            const finalResult = Math.floor(Math.random() * 6) + 1;
            diceContainer.textContent = finalResult;
            diceContainer.classList.remove("rolling");

            // ê²°ê³¼ íŒì •
            const isOdd = finalResult % 2 === 1;
            const userChoice = selectedChoice;
            const isWin =
              (isOdd && userChoice === "odd") ||
              (!isOdd && userChoice === "even");

            setTimeout(() => {
              showResult(finalResult, isWin, betAmount);
            }, 500);
          }
        }, 100);
      }

      // ê²°ê³¼ í‘œì‹œ
      function showResult(number, isWin, betAmount) {
        const resultDisplay = document.getElementById("resultDisplay");
        const isOdd = number % 2 === 1;

        // í¬ì¸íŠ¸ ê³„ì‚°
        let pointChange = 0;
        if (isWin) {
          pointChange = Math.floor(betAmount * 1.95);
          currentPoints += pointChange;
        } else {
          pointChange = -betAmount;
          currentPoints += pointChange;
        }

        // ê²°ê³¼ ë©”ì‹œì§€ ìƒì„±
        const resultHTML = `
        <div class="dice-container">${number}</div>
        <div class="result-text">${isOdd ? "í™€" : "ì§"} ë‚˜ì™”ìŠµë‹ˆë‹¤!</div>
        <div class="result-message ${isWin ? "win" : "lose"}">
          ${isWin ? "ğŸ‰ ìŠ¹ë¦¬!" : "ğŸ˜¢ íŒ¨ë°°"}
        </div>
        <div class="result-amount ${isWin ? "win" : "lose"}">
          ${pointChange > 0 ? "+" : ""}${pointChange.toLocaleString()}ì›
        </div>
      `;

        resultDisplay.innerHTML = resultHTML;

        // í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
        updatePoints();

        // ìµœê·¼ ê²°ê³¼ì— ì¶”ê°€
        addRecentResult(
          number,
          isOdd ? "í™€" : "ì§",
          selectedChoice === "odd" ? "í™€" : "ì§",
          isWin,
          betAmount,
          pointChange,
        );

        // ë²„íŠ¼ í™œì„±í™”
        setTimeout(() => {
          isPlaying = false;
          document.getElementById("betButton").disabled = false;
        }, 2000);
      }

      // í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
      function updatePoints() {
        document.getElementById("currentPoints").textContent =
          currentPoints.toLocaleString() + "ì›";
        document.getElementById("headerPoints").textContent =
          currentPoints.toLocaleString();
      }

      // ìµœê·¼ ê²°ê³¼ ì¶”ê°€
      function addRecentResult(
        number,
        result,
        choice,
        isWin,
        betAmount,
        pointChange,
      ) {
        const time = new Date().toLocaleTimeString("ko-KR");
        const resultItem = {
          time,
          number,
          result,
          choice,
          isWin,
          betAmount,
          pointChange,
        };

        recentResults.unshift(resultItem);
        if (recentResults.length > 10) {
          recentResults.pop();
        }

        renderRecentResults();
      }

      // ìµœê·¼ ê²°ê³¼ ë Œë”ë§
      function renderRecentResults() {
        const resultList = document.getElementById("resultList");

        if (recentResults.length === 0) {
          resultList.innerHTML =
            '<div class="empty-state">ì•„ì§ ë² íŒ… ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
          return;
        }

        resultList.innerHTML = recentResults
          .map(
            (item) => `
        <div class="result-item">
          <div class="result-item-info">
            <div class="result-dice">${item.number}</div>
            <div>
              <div style="font-size: 12px; color: var(--text-muted);">${item.time}</div>
              <div style="font-size: 14px; color: var(--text-secondary);">
                ${item.choice} ì„ íƒ Â· ê²°ê³¼: ${item.result}
              </div>
            </div>
          </div>
          <div style="text-align: right;">
            <div style="font-size: 12px; color: var(--text-secondary);">
              ${item.betAmount.toLocaleString()}ì›
            </div>
            <div style="font-size: 18px; font-weight: 700; color: ${item.isWin ? "var(--accent-primary)" : "var(--accent-danger)"};">
              ${item.pointChange > 0 ? "+" : ""}${item.pointChange.toLocaleString()}ì›
            </div>
          </div>
        </div>
      `,
          )
          .join("");
      }

      // ì´ˆê¸°í™”
      renderRecentResults();
    </script>
  </body>
</html>
